<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
    <?php include_once("header.php")?>
    <?php include("classes/database.php");
    use classes\database;
    $variable = new database("localhost", "root", "", "todos",3306);
    $id_todolists= $_GET['id'];

    if (isset($_POST['task'])) {
        if (!empty($_POST['task'])) {
            $variable->addTaskForList($_POST['task'],$id_todolists);
        }
    }
    if (isset($_POST['delete'])) {
            if($variable->deleteTask($_POST['delete'])){
                header('Location: todoDetail.php?id='.$id_todolists);
            }
    }
    if (isset($_POST['complete'])) {
        if($variable->completeTask($_POST['complete'])){
            header('Location: todoDetail.php?id='.$id_todolists);
        }
    }

    $tasks = $variable->displayTasks($id_todolists);

    ?>
</head>
<body class="is-preload">

<!-- Sidebar -->
<section id="sidebar">
    <?php include_once("nav.php");?>
</section>

<!-- Wrapper -->

    <div id="wrapper">

            <div id="todos" class="wrapper style1 fullscreen fade-up">

                <div class="inner">
                    <a href="todo.php"><i class="fas fa-arrow-left"></i></a>
                    <div id="row">

                        <h2>
                        </h2>
                        <h3>Add your task to PotaToDo</h3>
                         <section>
                            <form method="post" action="todoDetail.php?id=<?php echo $id_todolists; ?>">
                                <div class="fields">
                                    <div class="field half">

                                        <input type="text" name="task" id="task"  placeholder="for example: potatoes" required>
                                    </div>
                                </div>
                                    <ul class="actions">
                                        <li><button type="submit">Add</button></li>
                                    </ul>
                            </form>

                         </section>
                    </div>
                <div id="row">
                    <?php if($tasks){
                    foreach ($tasks as $key => $task){
                        if($task['checked']==0){
                        ?>

                            <div style="display:flex;">

                    <p> <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                             width="24" height="24"
                             viewBox="0 0 172 172"
                             style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="normal" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="#5e42a6"></path><g fill="#cccccc"><path d="M106.4418,27.52c-8.25785,0 -15.76693,3.93059 -22.73961,9.52719c-6.97268,5.5966 -13.48825,12.90856 -19.85055,20.03195c-1.28256,1.43386 -2.56379,2.86496 -3.84313,4.2832c-3.94997,4.37089 -8.56702,8.50278 -13.08141,12.53047c-0.00112,0 -0.00224,0 -0.00336,0c-8.30592,7.41409 -16.23641,14.40251 -20.24695,22.9882c-4.01054,8.58569 -3.73195,18.72921 3.9607,31.27578c7.70877,12.57291 22.18991,19.71281 39.4357,19.71281c19.21199,0 38.85301,-8.50837 52.71531,-22.79c0.00112,0 0.00224,0 0.00336,0c14.96197,-15.41856 23.35508,-38.00584 21.41602,-57.93578c-1.35473,-13.95518 -7.69913,-25.37211 -18.27836,-32.71023c-6.61092,-4.58471 -13.03348,-6.91359 -19.48773,-6.91359zM106.4418,30.96c5.6339,0 11.31934,1.99458 17.52586,6.29883c9.74429,6.75899 15.54361,17.09996 16.81703,30.21758c1.82086,18.71502 -6.22864,40.54029 -20.46195,55.20797c-13.20361,13.60301 -32.0584,21.74523 -50.24953,21.74523c-16.30452,0 -29.49198,-6.63523 -36.50297,-18.07008c-7.29715,-11.90151 -7.34329,-20.38362 -3.77594,-28.02055c3.56735,-7.63692 11.1147,-14.46558 19.42055,-21.87961c4.51561,-4.02879 9.22653,-8.23315 13.3468,-12.7925c1.28635,-1.42602 2.57344,-2.86216 3.85656,-4.29664c6.36227,-7.12337 12.79236,-14.30533 19.43735,-19.63891c6.64499,-5.33357 13.42429,-8.77133 20.58625,-8.77133zM114.38,49.88c-1.36167,0 -2.49069,0.54159 -3.22164,1.36391c-0.73095,0.82232 -1.07836,1.88498 -1.07836,2.93609c0,1.05111 0.34741,2.11378 1.07836,2.93609c0.73095,0.82232 1.85998,1.36391 3.22164,1.36391c1.36167,0 2.49069,-0.54159 3.22164,-1.36391c0.73095,-0.82232 1.07836,-1.88498 1.07836,-2.93609c0,-1.05111 -0.34741,-2.11378 -1.07836,-2.93609c-0.73095,-0.82232 -1.85998,-1.36391 -3.22164,-1.36391zM114.38,51.6c0.93167,0 1.52264,0.31841 1.93836,0.78609c0.41572,0.46768 0.64164,1.12502 0.64164,1.79391c0,0.66889 -0.22592,1.32622 -0.64164,1.79391c-0.41572,0.46768 -1.00669,0.78609 -1.93836,0.78609c-0.93167,0 -1.52264,-0.31841 -1.93836,-0.78609c-0.41572,-0.46768 -0.64164,-1.12502 -0.64164,-1.79391c0,-0.66889 0.22592,-1.32622 0.64164,-1.79391c0.41572,-0.46768 1.00669,-0.78609 1.93836,-0.78609zM94.6,60.2c-2.22167,0 -3.99569,0.86409 -5.15664,2.17016c-1.16095,1.30607 -1.72336,3.01373 -1.72336,4.70984c0,1.69611 0.56241,3.40378 1.72336,4.70984c1.16095,1.30607 2.93498,2.17016 5.15664,2.17016c2.22167,0 3.99569,-0.86409 5.15664,-2.17016c1.16095,-1.30607 1.72336,-3.01373 1.72336,-4.70984c0,-1.69611 -0.56241,-3.40378 -1.72336,-4.70984c-1.16095,-1.30607 -2.93498,-2.17016 -5.15664,-2.17016zM94.6,61.92c1.79167,0 3.02764,0.64091 3.87336,1.59234c0.84572,0.95143 1.28664,2.25377 1.28664,3.56766c0,1.31389 -0.44092,2.61622 -1.28664,3.56766c-0.84572,0.95143 -2.08169,1.59234 -3.87336,1.59234c-1.79167,0 -3.02764,-0.64091 -3.87336,-1.59234c-0.84572,-0.95143 -1.28664,-2.25377 -1.28664,-3.56766c0,-1.31389 0.44092,-2.61622 1.28664,-3.56766c0.84572,-0.95143 2.08169,-1.59234 3.87336,-1.59234zM113.52,77.4c-1.075,0 -1.98903,0.43409 -2.57664,1.09516c-0.58761,0.66107 -0.86336,1.50873 -0.86336,2.34484c0,0.83611 0.27575,1.68378 0.86336,2.34484c0.58761,0.66107 1.50164,1.09516 2.57664,1.09516c1.075,0 1.98903,-0.43409 2.57664,-1.09516c0.58761,-0.66107 0.86336,-1.50873 0.86336,-2.34484c0,-0.83611 -0.27575,-1.68378 -0.86336,-2.34484c-0.58761,-0.66107 -1.50164,-1.09516 -2.57664,-1.09516zM113.52,79.12c0.645,0 1.02097,0.21091 1.29336,0.51734c0.27239,0.30643 0.42664,0.74877 0.42664,1.20266c0,0.45389 -0.15425,0.89622 -0.42664,1.20266c-0.27238,0.30643 -0.64836,0.51734 -1.29336,0.51734c-0.645,0 -1.02097,-0.21091 -1.29336,-0.51734c-0.27239,-0.30643 -0.42664,-0.74877 -0.42664,-1.20266c0,-0.45389 0.15425,-0.89622 0.42664,-1.20266c0.27238,-0.30643 0.64836,-0.51734 1.29336,-0.51734zM70.52,104.92c-1.075,0 -1.98903,0.43409 -2.57664,1.09516c-0.58761,0.66107 -0.86336,1.50873 -0.86336,2.34484c0,0.83611 0.27575,1.68378 0.86336,2.34484c0.58761,0.66107 1.50164,1.09516 2.57664,1.09516c1.075,0 1.98903,-0.43409 2.57664,-1.09516c0.58761,-0.66107 0.86336,-1.50873 0.86336,-2.34484c0,-0.83611 -0.27575,-1.68378 -0.86336,-2.34484c-0.58761,-0.66107 -1.50164,-1.09516 -2.57664,-1.09516zM70.52,106.64c0.645,0 1.02097,0.21091 1.29336,0.51734c0.27239,0.30643 0.42664,0.74877 0.42664,1.20266c0,0.45389 -0.15425,0.89622 -0.42664,1.20266c-0.27238,0.30643 -0.64836,0.51734 -1.29336,0.51734c-0.645,0 -1.02097,-0.21091 -1.29336,-0.51734c-0.27239,-0.30643 -0.42664,-0.74877 -0.42664,-1.20266c0,-0.45389 0.15425,-0.89622 0.42664,-1.20266c0.27238,-0.30643 0.64836,-0.51734 1.29336,-0.51734zM49.88,116.96c-1.075,0 -1.98903,0.43409 -2.57664,1.09516c-0.58761,0.66107 -0.86336,1.50873 -0.86336,2.34484c0,0.83611 0.27575,1.68378 0.86336,2.34484c0.58761,0.66107 1.50164,1.09516 2.57664,1.09516c1.075,0 1.98903,-0.43409 2.57664,-1.09516c0.58761,-0.66107 0.86336,-1.50873 0.86336,-2.34484c0,-0.83611 -0.27575,-1.68378 -0.86336,-2.34484c-0.58761,-0.66107 -1.50164,-1.09516 -2.57664,-1.09516zM49.88,118.68c0.645,0 1.02097,0.21091 1.29336,0.51734c0.27239,0.30643 0.42664,0.74877 0.42664,1.20266c0,0.45389 -0.15425,0.89622 -0.42664,1.20266c-0.27238,0.30643 -0.64836,0.51734 -1.29336,0.51734c-0.645,0 -1.02097,-0.21091 -1.29336,-0.51734c-0.27239,-0.30643 -0.42664,-0.74877 -0.42664,-1.20266c0,-0.45389 0.15425,-0.89622 0.42664,-1.20266c0.27238,-0.30643 0.64836,-0.51734 1.29336,-0.51734zM70.52,127.28c-1.075,0 -1.98903,0.43409 -2.57664,1.09516c-0.58761,0.66107 -0.86336,1.50873 -0.86336,2.34484c0,0.83611 0.27575,1.68378 0.86336,2.34484c0.58761,0.66107 1.50164,1.09516 2.57664,1.09516c1.075,0 1.98903,-0.43409 2.57664,-1.09516c0.58761,-0.66107 0.86336,-1.50873 0.86336,-2.34484c0,-0.83611 -0.27575,-1.68378 -0.86336,-2.34484c-0.58761,-0.66107 -1.50164,-1.09516 -2.57664,-1.09516zM70.52,129c0.645,0 1.02097,0.21091 1.29336,0.51734c0.27239,0.30643 0.42664,0.74877 0.42664,1.20266c0,0.45389 -0.15425,0.89622 -0.42664,1.20266c-0.27238,0.30643 -0.64836,0.51734 -1.29336,0.51734c-0.645,0 -1.02097,-0.21091 -1.29336,-0.51734c-0.27239,-0.30643 -0.42664,-0.74877 -0.42664,-1.20266c0,-0.45389 0.15425,-0.89622 0.42664,-1.20266c0.27238,-0.30643 0.64836,-0.51734 1.29336,-0.51734z"></path></g></g></svg>
                            <?php echo $task['task']; ?></p>
                                <div style="margin-left:auto; display:flex;">
                                    <form action="todoDetail.php?id=<?php echo $id_todolists ?>" method="post">
                                        <input type="hidden" name="delete" value="<?php echo $task['id_task']; ?>" />
                                        <button type="submit" class="small" onclick="return confirm('Are you sure, that you want to delete this task?')"><i class="fas fa-trash"></i></button>
                                    </form>

                                    <form action="todoDetail.php?id=<?php echo $id_todolists ?>" method="post">
                                        <input type="hidden" name="complete" value="<?php echo $task['id_task']; ?>" />
                            <button type="submit" class="small"><i class="fas fa-check"></i></button>
                                    </form>
                                </div>
                            </div>
                        </form>
                    <?php }else{ ?>
                                <div style="display:flex;">
                                    <p><s><?php echo $task['task']; ?></s></p>
                                    <div style="margin-left:auto; display:flex;">
                                        <form action="todoDetail.php?id=<?php echo $id_todolists ?>" method="post">
                                            <input type="hidden" name="delete" value="<?php echo $task['id_task']; ?>" />
                                            <button type="submit" onclick=" confirm('Are you sure, that you want to delete this task?')"><i class="fas fa-trash"></i></button>
                                        </form>
                                    </div>
                                </div>
                        <?php }
                    }} else{ ?>
                        <h3>Zero tasks in your potaToDo. Add something</h3>
                        <ul class="actions">
                        </ul>
                    <?php }?>

                </div>
                </div>

            <section id="logout" class="wrapper style1 fullscreen fade-up" >
                    <p id="logout"></p>
            </section>
    </div>

<footer id="footer" class="wrapper style1-alt">
    <?php include_once("footer.php");?>
</footer>
</body>
</html>